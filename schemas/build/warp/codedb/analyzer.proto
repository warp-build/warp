syntax = "proto3";
package build.warp.codedb;

import "build/warp/common.proto";

service AnalyzerService {
  rpc GetInterestedPaths(GetInterestedPathsRequest) returns (GetInterestedPathsResponse);

  rpc GetProvidedSymbols(GetProvidedSymbolsRequest) returns (GetProvidedSymbolsResponse);

  rpc GetAst(GetAstRequest) returns (GetAstResponse);

  rpc GenerateSignature(GenerateSignatureRequest) returns (GenerateSignatureResponse);
}

message GenerateSignatureRequest {
  string file = 1;
}

message GenerateSignatureResponse {
  Status status = 1;
  string file = 2;
  string json_signature = 3;
  repeated Signature signatures = 4;
}

message GetAstRequest {
  string file = 1;
  Symbol symbol = 2;
}

message GetAstResponse {
  Status status = 1;
  string file = 2;
  Symbol symbol = 3;
  string source = 4;
  string ast = 5;
}

message GetInterestedPathsRequest {}

message GetInterestedPathsResponse {
  repeated string build_files = 1;
  repeated string test_files = 2;
}

message GetProvidedSymbolsRequest {
  string file = 1;
}

message GetProvidedSymbolsResponse {
  bool skipped = 1;
  string file = 2;
  repeated Requirement provides = 3;
}
