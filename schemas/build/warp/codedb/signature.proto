syntax = "proto3";
package build.warp.codedb;

service SignatureService {
  rpc GenerateSignature(GenerateSignatureRequest) returns (GenerateSignatureResponse);
}

message GenerateSignatureRequest {
  string file = 1;
  string symbol = 2;
}

message GenerateSignatureResponse {
  Status status = 1;
  Signature signature = 2;
}

enum Status {
  STATUS_UNKNOWN = 0;
  STATUS_OK = 1;
  STATUS_ERR = 2;
}

message Signature {
  string label_name = 1;
  string rule_name = 2;
  repeated Requirement deps = 2;
  repeated Requirement runtime_deps = 2;
}

message FileRequirement {
  string path = 1;
}

message ModuleRequirement {
  string name = 1;
}

message SymbolRequirement {
  string raw = 1;
}

message Requirement {
  oneof requirement {
    FileRequirement file = 1;
    ModuleRequirement module = 2;
    SymbolRequirement symbol = 3;
  }
}
